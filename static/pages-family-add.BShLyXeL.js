import{_ as a,c as e,w as t,x as l,a as s,d as n,h as o,y as r,i,r as d,o as c,e as m,j as f,k as u,I as h,K as g,t as p,f as _,D as b,q as v}from"./js/index.DiTfkHc-.js";import{P as C}from"./PageHeader.Bk91XqsU.js";import{b as x}from"./family.4SulrOfU.js";import"./request.BnSz9hlZ.js";const D=a({components:{PageHeader:C},data:()=>({formData:{name:"",relationship:"",phoneNumber:"",gender:"",birthday:"",avatar:"",sharingEnabled:!0},relationIndex:-1,genderIndex:-1,relationOptions:["父亲","母亲","儿子","女儿","丈夫","妻子","祖父","祖母","外祖父","外祖母","其他"],genderOptions:["男","女"]}),computed:{isFormValid(){return this.formData.name.trim()&&this.formData.relationship}},methods:{onRelationChange(a){this.relationIndex=a.detail.value,this.formData.relationship=this.relationOptions[this.relationIndex]},onGenderChange(a){this.genderIndex=a.detail.value,this.formData.gender=this.genderOptions[this.genderIndex]},onBirthdayChange(a){this.formData.birthday=a.detail.value},onSharingChange(a){this.formData.sharingEnabled=a.detail.value},chooseAvatar(){r({count:1,sizeType:["compressed"],sourceType:["album","camera"],success:a=>{this.formData.avatar=a.tempFilePaths[0]}})},async saveMember(){if(this.isFormValid)try{n({title:"保存中..."});const a=await x(this.formData);0===a.code?(s({title:"添加成功",icon:"success"}),setTimeout((()=>{l()}),1500)):s({title:a.message||"添加失败",icon:"none"})}catch(a){console.error("添加家庭成员失败:",a),s({title:"添加失败",icon:"none"})}finally{o()}else s({title:"请填写必填项",icon:"none"})},cancel(){l()}}},[["render",function(a,l,s,n,o,r){const C=d("page-header"),x=f,D=h,k=i,y=g,I=_,V=b,O=v;return c(),e(k,{class:"container"},{default:t((()=>[m(C,{title:"添加家庭成员"}),m(k,{class:"content"},{default:t((()=>[m(k,{class:"form-section"},{default:t((()=>[m(k,{class:"form-item"},{default:t((()=>[m(x,{class:"form-label"},{default:t((()=>[u("姓名 *")])),_:1}),m(D,{class:"form-input",modelValue:o.formData.name,"onUpdate:modelValue":l[0]||(l[0]=a=>o.formData.name=a),placeholder:"请输入姓名",maxlength:"20"},null,8,["modelValue"])])),_:1}),m(k,{class:"form-item"},{default:t((()=>[m(x,{class:"form-label"},{default:t((()=>[u("关系 *")])),_:1}),m(y,{class:"form-picker",value:o.relationIndex,range:o.relationOptions,onChange:r.onRelationChange},{default:t((()=>[m(k,{class:"picker-text"},{default:t((()=>[u(p(o.relationOptions[o.relationIndex]||"请选择关系"),1)])),_:1})])),_:1},8,["value","range","onChange"])])),_:1}),m(k,{class:"form-item"},{default:t((()=>[m(x,{class:"form-label"},{default:t((()=>[u("手机号")])),_:1}),m(D,{class:"form-input",modelValue:o.formData.phoneNumber,"onUpdate:modelValue":l[1]||(l[1]=a=>o.formData.phoneNumber=a),placeholder:"请输入手机号",type:"number",maxlength:"11"},null,8,["modelValue"])])),_:1}),m(k,{class:"form-item"},{default:t((()=>[m(x,{class:"form-label"},{default:t((()=>[u("性别")])),_:1}),m(y,{class:"form-picker",value:o.genderIndex,range:o.genderOptions,onChange:r.onGenderChange},{default:t((()=>[m(k,{class:"picker-text"},{default:t((()=>[u(p(o.genderOptions[o.genderIndex]||"请选择性别"),1)])),_:1})])),_:1},8,["value","range","onChange"])])),_:1}),m(k,{class:"form-item"},{default:t((()=>[m(x,{class:"form-label"},{default:t((()=>[u("生日")])),_:1}),m(y,{class:"form-picker",mode:"date",value:o.formData.birthday,onChange:r.onBirthdayChange},{default:t((()=>[m(k,{class:"picker-text"},{default:t((()=>[u(p(o.formData.birthday||"请选择生日"),1)])),_:1})])),_:1},8,["value","onChange"])])),_:1}),m(k,{class:"form-item"},{default:t((()=>[m(x,{class:"form-label"},{default:t((()=>[u("头像")])),_:1}),m(k,{class:"avatar-upload",onClick:r.chooseAvatar},{default:t((()=>[o.formData.avatar?(c(),e(k,{key:0,class:"avatar-preview"},{default:t((()=>[m(I,{src:o.formData.avatar,class:"avatar-image"},null,8,["src"])])),_:1})):(c(),e(k,{key:1,class:"avatar-placeholder"},{default:t((()=>[m(x,{class:"avatar-icon"},{default:t((()=>[u("📷")])),_:1}),m(x,{class:"avatar-text"},{default:t((()=>[u("点击上传头像")])),_:1})])),_:1}))])),_:1},8,["onClick"])])),_:1})])),_:1}),m(k,{class:"sharing-section"},{default:t((()=>[m(k,{class:"section-title"},{default:t((()=>[u("数据共享设置")])),_:1}),m(k,{class:"sharing-item"},{default:t((()=>[m(x,{class:"sharing-label"},{default:t((()=>[u("健康数据共享")])),_:1}),m(V,{checked:o.formData.sharingEnabled,onChange:r.onSharingChange,color:"#6C63FF"},null,8,["checked","onChange"])])),_:1}),m(k,{class:"sharing-desc"},{default:t((()=>[m(x,null,{default:t((()=>[u("开启后，该家庭成员可以查看您的健康数据")])),_:1})])),_:1})])),_:1}),m(k,{class:"action-buttons"},{default:t((()=>[m(O,{class:"action-btn cancel-btn",onClick:r.cancel},{default:t((()=>[u("取消")])),_:1},8,["onClick"]),m(O,{class:"action-btn confirm-btn",onClick:r.saveMember,disabled:!r.isFormValid},{default:t((()=>[u(" 保存 ")])),_:1},8,["onClick","disabled"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-31f06755"]]);export{D as default};
