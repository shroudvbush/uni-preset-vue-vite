import{B as e,L as t,a,M as r,C as o,n as s}from"./js/index.DiTfkHc-.js";const n={config:{baseURL:"https://enzkmpypbsrx.sealoshzh.site",header:{"Content-Type":"application/json;charset=UTF-8"},timeout:6e4,dataType:"json"},interceptor:{request:t=>{const a=e("token");if(a&&(t.header.Authorization=`Bearer ${a}`),!t.url.startsWith("http")){const e=t.url.replace(/^\/+/,"");t.url=`${t.baseURL}/api/${e}`}return t.data&&"object"==typeof t.data&&(t.data instanceof FormData||Object.keys(t.data).forEach((e=>{void 0!==t.data[e]&&null!==t.data[e]||delete t.data[e]}))),console.log("Request URL:",t.url),console.log("Request Data:",t.data),t},response:e=>{if(console.log("Response:",e),!e.data)return Promise.reject(new Error("响应数据为空"));const{data:t}=e;return 0!==t.code?(401===t.code?(o("token"),a({title:"请重新登录",icon:"none",duration:2e3}),setTimeout((()=>{s({url:"/pages/login/index"})}),1500)):a({title:t.message||"请求失败",icon:"none",duration:2e3}),Promise.reject(t)):t.data}},request(e={}){return e.baseURL=e.baseURL||this.config.baseURL,e.dataType=e.dataType||this.config.dataType,e.timeout=e.timeout||this.config.timeout,e.header={...this.config.header,...e.header||{}},e.method=e.method||"GET",e=this.interceptor.request(e),new Promise(((t,o)=>{e.success=e=>{try{t(this.interceptor.response(e))}catch(a){o(a)}},e.fail=e=>{console.error("Request failed:",e),a({title:"网络请求失败",icon:"none",duration:2e3}),o(e)},r(e)}))},get(e,t={},a={}){return this.request({...a,url:e,data:t,method:"GET"})},post(e,t={},a={}){return this.request({...a,url:e,data:t,method:"POST"})},put(e,t={},a={}){return this.request({...a,url:e,data:t,method:"PUT"})},delete(e,t={},a={}){return this.request({...a,url:e,data:t,method:"DELETE"})},upload(r,o,s="file",n={},i={}){const d=e("token"),c=d?{Authorization:`Bearer ${d}`}:{};return r.startsWith("http")||(r=`${this.config.baseURL}/api/${r.replace(/^\/+/,"")}`),new Promise(((e,i)=>{t({url:r,filePath:o,name:s,formData:n,header:c,success:t=>{try{if("string"==typeof t.data&&(t.data=JSON.parse(t.data)),0===t.data.code)e(t.data.data);else{const e=new Error(t.data.message||"上传失败");e.code=t.data.code,e.data=t.data,a({title:e.message,icon:"none",duration:2e3}),i(e)}}catch(r){i(new Error("解析响应数据失败"))}},fail:e=>{console.error("Upload failed:",e),a({title:"网络异常，请稍后重试",icon:"none",duration:2e3}),i(new Error("网络异常，请稍后重试"))}})}))}};export{n as r};
