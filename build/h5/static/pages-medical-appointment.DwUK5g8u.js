import{_ as e,c as a,w as t,a as l,d as s,x as i,h as o,i as d,r as c,o as n,e as u,m,j as r,k as f,t as p,u as h,F as _,v,p as D,I as y,q as b}from"./js/index.DbooXYOL.js";import{P as I}from"./PageHeader.TnuYEyYk.js";import{m as g}from"./medical.MXff4p1j.js";import"./request.DRycooUd.js";const C=e({components:{PageHeader:I},data:()=>({hospitalId:"",hospitalInfo:null,departments:[],doctors:[],availableDates:[],availableTimes:[],selectedDepartment:"",selectedDoctor:"",selectedDate:"",selectedTime:"",patientInfo:{name:"",idCard:"",phone:""}}),computed:{selectedDepartmentInfo(){return this.departments.find((e=>e.id===this.selectedDepartment))},selectedDoctorInfo(){return this.doctors.find((e=>e.id===this.selectedDoctor))},isFormComplete(){return this.selectedDepartment&&this.selectedDoctor&&this.selectedDate&&this.selectedTime&&this.patientInfo.name&&this.patientInfo.idCard&&this.patientInfo.phone}},onLoad(e){e.hospitalId&&(this.hospitalId=e.hospitalId,this.loadHospitalInfo(),this.loadDepartments())},methods:{async loadHospitalInfo(){this.hospitalInfo={id:this.hospitalId,name:"北京协和医院",level:"三甲医院",address:"北京市东城区东单帅府园1号"}},async loadDepartments(){this.departments=[{id:"1",name:"内科",icon:"🏥"},{id:"2",name:"外科",icon:"🔪"},{id:"3",name:"妇产科",icon:"👶"},{id:"4",name:"儿科",icon:"👶"},{id:"5",name:"眼科",icon:"👁️"},{id:"6",name:"骨科",icon:"🦴"}]},async selectDepartment(e){this.selectedDepartment=e.id,this.selectedDoctor="",this.selectedDate="",this.selectedTime="",await this.loadDoctors()},async loadDoctors(){this.doctors=[{id:"1",name:"张医生",title:"主任医师",specialty:"心血管疾病",rating:4.8,consultationCount:1250,fee:50},{id:"2",name:"李医生",title:"副主任医师",specialty:"消化系统疾病",rating:4.6,consultationCount:980,fee:40},{id:"3",name:"王医生",title:"主治医师",specialty:"呼吸系统疾病",rating:4.5,consultationCount:750,fee:30}]},async selectDoctor(e){this.selectedDoctor=e.id,this.selectedDate="",this.selectedTime="",await this.loadAvailableDates()},async loadAvailableDates(){const e=new Date;this.availableDates=[];for(let a=1;a<=7;a++){const t=new Date(e);t.setDate(e.getDate()+a),this.availableDates.push({value:this.formatDate(t),day:this.getDayName(t.getDay()),status:a<=3?"可预约":"约满"})}},async selectDate(e){this.selectedDate=e.value,this.selectedTime="",await this.loadAvailableTimes()},async loadAvailableTimes(){this.availableTimes=[{value:"09:00",label:"09:00",available:!0},{value:"09:30",label:"09:30",available:!0},{value:"10:00",label:"10:00",available:!1},{value:"10:30",label:"10:30",available:!0},{value:"14:00",label:"14:00",available:!0},{value:"14:30",label:"14:30",available:!0},{value:"15:00",label:"15:00",available:!1},{value:"15:30",label:"15:30",available:!0}]},selectTime(e){e.available&&(this.selectedTime=e.value)},formatDate:e=>`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`,getDayName:e=>`周${["日","一","二","三","四","五","六"][e]}`,async submitAppointment(){if(this.isFormComplete)try{s({title:"预约中..."});const e={hospitalId:this.hospitalId,departmentId:this.selectedDepartment,doctorId:this.selectedDoctor,appointmentDate:this.selectedDate,appointmentTime:this.selectedTime,patientInfo:this.patientInfo},a=await g(e);0===a.code?(l({title:"预约成功",icon:"success"}),setTimeout((()=>{i()}),1500)):l({title:a.message||"预约失败",icon:"none"})}catch(e){console.error("预约失败:",e),l({title:"预约失败",icon:"none"})}finally{o()}else l({title:"请完善预约信息",icon:"none"})}}},[["render",function(e,l,s,i,o,I){const g=c("page-header"),C=r,k=d,T=y,V=b;return n(),a(k,{class:"container"},{default:t((()=>[u(g,{title:"预约挂号"}),u(k,{class:"content"},{default:t((()=>[o.hospitalInfo?(n(),a(k,{key:0,class:"hospital-info"},{default:t((()=>[u(k,{class:"hospital-header"},{default:t((()=>[u(C,{class:"hospital-name"},{default:t((()=>[f(p(o.hospitalInfo.name),1)])),_:1}),u(C,{class:"hospital-level"},{default:t((()=>[f(p(o.hospitalInfo.level),1)])),_:1})])),_:1}),u(C,{class:"hospital-address"},{default:t((()=>[f("📍 "+p(o.hospitalInfo.address),1)])),_:1})])),_:1})):m("",!0),u(k,{class:"section"},{default:t((()=>[u(k,{class:"section-title"},{default:t((()=>[f("选择科室")])),_:1}),u(k,{class:"department-grid"},{default:t((()=>[(n(!0),h(_,null,v(o.departments,(e=>(n(),a(k,{class:D(["department-item",{active:o.selectedDepartment===e.id}]),key:e.id,onClick:a=>I.selectDepartment(e)},{default:t((()=>[u(C,{class:"department-icon"},{default:t((()=>[f(p(e.icon),1)])),_:2},1024),u(C,{class:"department-name"},{default:t((()=>[f(p(e.name),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1}),o.selectedDepartment?(n(),a(k,{key:1,class:"section"},{default:t((()=>[u(k,{class:"section-title"},{default:t((()=>[f("选择医生")])),_:1}),u(k,{class:"doctor-list"},{default:t((()=>[(n(!0),h(_,null,v(o.doctors,(e=>(n(),a(k,{class:D(["doctor-item",{active:o.selectedDoctor===e.id}]),key:e.id,onClick:a=>I.selectDoctor(e)},{default:t((()=>[u(k,{class:"doctor-avatar"},{default:t((()=>[u(C,null,{default:t((()=>[f(p(e.name.charAt(0)),1)])),_:2},1024)])),_:2},1024),u(k,{class:"doctor-info"},{default:t((()=>[u(k,{class:"doctor-header"},{default:t((()=>[u(C,{class:"doctor-name"},{default:t((()=>[f(p(e.name),1)])),_:2},1024),u(C,{class:"doctor-title"},{default:t((()=>[f(p(e.title),1)])),_:2},1024)])),_:2},1024),u(C,{class:"doctor-specialty"},{default:t((()=>[f(p(e.specialty),1)])),_:2},1024),u(k,{class:"doctor-rating"},{default:t((()=>[u(C,{class:"rating-score"},{default:t((()=>[f(p(e.rating),1)])),_:2},1024),u(C,{class:"rating-star"},{default:t((()=>[f("⭐")])),_:1}),u(C,{class:"consultation-count"},{default:t((()=>[f("已接诊 "+p(e.consultationCount)+" 人",1)])),_:2},1024)])),_:2},1024)])),_:2},1024),u(k,{class:"doctor-fee"},{default:t((()=>[u(C,{class:"fee-amount"},{default:t((()=>[f("¥"+p(e.fee),1)])),_:2},1024)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})):m("",!0),o.selectedDoctor?(n(),a(k,{key:2,class:"section"},{default:t((()=>[u(k,{class:"section-title"},{default:t((()=>[f("选择日期")])),_:1}),u(k,{class:"date-picker"},{default:t((()=>[(n(!0),h(_,null,v(o.availableDates,(e=>(n(),a(k,{class:D(["date-item",{active:o.selectedDate===e.value}]),key:e.value,onClick:a=>I.selectDate(e)},{default:t((()=>[u(C,{class:"date-day"},{default:t((()=>[f(p(e.day),1)])),_:2},1024),u(C,{class:"date-value"},{default:t((()=>[f(p(e.value),1)])),_:2},1024),u(C,{class:"date-status"},{default:t((()=>[f(p(e.status),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})):m("",!0),o.selectedDate?(n(),a(k,{key:3,class:"section"},{default:t((()=>[u(k,{class:"section-title"},{default:t((()=>[f("选择时间段")])),_:1}),u(k,{class:"time-grid"},{default:t((()=>[(n(!0),h(_,null,v(o.availableTimes,(e=>(n(),a(k,{class:D(["time-item",{active:o.selectedTime===e.value,disabled:!e.available}]),key:e.value,onClick:a=>I.selectTime(e)},{default:t((()=>[u(C,null,{default:t((()=>[f(p(e.label),1)])),_:2},1024)])),_:2},1032,["class","onClick"])))),128))])),_:1})])),_:1})):m("",!0),u(k,{class:"section"},{default:t((()=>[u(k,{class:"section-title"},{default:t((()=>[f("患者信息")])),_:1}),u(k,{class:"patient-form"},{default:t((()=>[u(k,{class:"form-item"},{default:t((()=>[u(C,{class:"form-label"},{default:t((()=>[f("姓名")])),_:1}),u(T,{class:"form-input",modelValue:o.patientInfo.name,"onUpdate:modelValue":l[0]||(l[0]=e=>o.patientInfo.name=e),placeholder:"请输入患者姓名"},null,8,["modelValue"])])),_:1}),u(k,{class:"form-item"},{default:t((()=>[u(C,{class:"form-label"},{default:t((()=>[f("身份证号")])),_:1}),u(T,{class:"form-input",modelValue:o.patientInfo.idCard,"onUpdate:modelValue":l[1]||(l[1]=e=>o.patientInfo.idCard=e),placeholder:"请输入身份证号",type:"idcard"},null,8,["modelValue"])])),_:1}),u(k,{class:"form-item"},{default:t((()=>[u(C,{class:"form-label"},{default:t((()=>[f("手机号")])),_:1}),u(T,{class:"form-input",modelValue:o.patientInfo.phone,"onUpdate:modelValue":l[2]||(l[2]=e=>o.patientInfo.phone=e),placeholder:"请输入手机号",type:"number"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),I.isFormComplete?(n(),a(k,{key:4,class:"appointment-summary"},{default:t((()=>[u(k,{class:"summary-title"},{default:t((()=>[f("预约信息")])),_:1}),u(k,{class:"summary-item"},{default:t((()=>[u(C,{class:"summary-label"},{default:t((()=>[f("医院：")])),_:1}),u(C,{class:"summary-value"},{default:t((()=>{var e;return[f(p(null==(e=o.hospitalInfo)?void 0:e.name),1)]})),_:1})])),_:1}),u(k,{class:"summary-item"},{default:t((()=>[u(C,{class:"summary-label"},{default:t((()=>[f("科室：")])),_:1}),u(C,{class:"summary-value"},{default:t((()=>{var e;return[f(p(null==(e=I.selectedDepartmentInfo)?void 0:e.name),1)]})),_:1})])),_:1}),u(k,{class:"summary-item"},{default:t((()=>[u(C,{class:"summary-label"},{default:t((()=>[f("医生：")])),_:1}),u(C,{class:"summary-value"},{default:t((()=>{var e;return[f(p(null==(e=I.selectedDoctorInfo)?void 0:e.name),1)]})),_:1})])),_:1}),u(k,{class:"summary-item"},{default:t((()=>[u(C,{class:"summary-label"},{default:t((()=>[f("时间：")])),_:1}),u(C,{class:"summary-value"},{default:t((()=>[f(p(o.selectedDate)+" "+p(o.selectedTime),1)])),_:1})])),_:1}),u(k,{class:"summary-item"},{default:t((()=>[u(C,{class:"summary-label"},{default:t((()=>[f("费用：")])),_:1}),u(C,{class:"summary-value fee"},{default:t((()=>{var e;return[f("¥"+p((null==(e=I.selectedDoctorInfo)?void 0:e.fee)||0),1)]})),_:1})])),_:1})])),_:1})):m("",!0),u(k,{class:"submit-section"},{default:t((()=>[u(V,{class:"submit-btn",disabled:!I.isFormComplete,onClick:I.submitAppointment},{default:t((()=>[u(C,null,{default:t((()=>[f("确认预约")])),_:1})])),_:1},8,["disabled","onClick"])])),_:1})])),_:1})])),_:1})}],["__scopeId","data-v-05f79e6d"]]);export{C as default};
